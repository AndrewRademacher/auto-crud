<h1>auto-crud</h1>

<h2>Introduction</h2>
auto-crud is an abstraction layer for generating REST routes to perform basic CRUD operations.  It glues together
express, mongo and json-schema validation.  The end goal is to define CRUD APIs in a declarative and uniform way
instead of writing route handlers directly.

<h2>Defining an API</h2>
The auto-crud module exports a single function which takes a configuration object as its only input.

```javascript
autocrud({
    app: app,                               // The express application object.
    collection: mongo.hoosit,               // The collection object generated by the mongo driver.
    name: 'hoosit',                         // The name of the object (this will be appended to the end of path).
    path: '/api',                           // The root URL path that this API should be generated at.
    schema: {                               // The json schema that should be used for validation
        type: 'object',
        properties: {
            name: {type: 'string', required: true},
            description: {type: 'string'},
            rating: {type: 'integer'},
            comments: {type: 'array', items: {type: 'string'}}
        },
        additionalProperties: false
    }
});
```

<h3>Configuration object parameters</h3>
* `app` The express application object.  This is used to generate REST routes for GET, POST, PUT and DELETE.
* `collection` The mongo collection object.  This is where the API will store its data.  NOTE: this tool will not ensure indexes.
* `name` The name of this API's objects, this will also be appended to the end of the path param when generating routes.
* `path` The root path for the routes generated by this API.
* `schema` The json-schema that will be used to validate objects given to the API by POST and PUT.

<h3>Input Transformation</h3>
It is often that input data from a client application differs from how you want to store data in your database.  So,
auto-crud allows you to specify transformation functions, which will be called after the input object has been
validated, but before a database insert or update.

```javascript
autocrud({
    app: app,                               // The express application object.
    collection: mongo.hoosit,               // The collection object generated by the mongo driver.
    name: 'hoosit',                         // The name of the object (this will be appended to the end of path).
    path: '/api',                           // The root URL path that this API should be generated at.
    schema: {                               // The json schema that should be used for validation
        type: 'object',
        properties: {
            name: {type: 'string', required: true},
            description: {type: 'string'},
            rating: {type: 'integer'},
            comments: {type: 'array', items: {type: 'string'}}
        },
        additionalProperties: false
    },
    postTransform: function (body) {
        if (!body.rating) body.rating = 1;
    }
});
```

* `defaultTransform` If specified, this transform function will be applied to both POST and PUT operations.
* `postTransform` If specified, this function will be used for POST operations, overriding the defaultTransform.
* `putTransform` If specified, this function will be used for PUT operations, overriding the defaultTransform.